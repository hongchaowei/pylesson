<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1è¯¾: ç›‘ç£å­¦ä¹ åœ¨é‡‘èé¢„æµ‹ä¸­çš„åº”ç”¨ - Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹</title>
    <link rel="stylesheet" href="../../css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="../../../js/financial-charts.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
    /* ç¡®ä¿ä»£ç å—å·¦å¯¹é½ */
    .lesson-content pre {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
        border-left: 4px solid #4299e1;
    }
    
    .lesson-content code {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 2px 5px;
        border-radius: 3px;
    }
    
    /* ç¡®ä¿preæ ‡ç­¾å†…çš„å†…å®¹å·¦å¯¹é½ */
    pre * {
        text-align: left !important;
    }
    
    /* ç¡®ä¿æ‰€æœ‰ä»£ç ç›¸å…³å…ƒç´ éƒ½å·¦å¯¹é½ */
    pre, code, .hljs {
        text-align: left !important;
    }
    </style>
    
</head>
<body>
<div id="navigation-container"></div>
<script>
// åŠ¨æ€åŠ è½½å¯¼èˆªæ¡
function loadNavigation() {
    fetch('../../nav.html')
        .then(response => response.text())
        .then(html => {
            // æ›´æ–°å¯¼èˆªä¸­çš„é“¾æ¥è·¯å¾„
            let updatedHtml = html;
            
            // å¤„ç†æ ¹ç›®å½•æ–‡ä»¶é“¾æ¥ï¼ˆindex.html, syllabus.htmlç­‰ï¼‰
            updatedHtml = updatedHtml.replace(/href="index\.html"/g, 'href="../../index.html"');
            updatedHtml = updatedHtml.replace(/href="\.\/([^/]*\.html)"/g, 'href="../../$1"');
            
            // å¤„ç†æ¨¡å—è·¯å¾„é“¾æ¥ï¼ˆå·²ç»æ˜¯å®Œæ•´ç›¸å¯¹è·¯å¾„ï¼Œåªéœ€è¦æ·»åŠ æ ¹è·¯å¾„å‰ç¼€ï¼‰
            updatedHtml = updatedHtml.replace(/href="\.\/part([^"]*)"/g, 'href="../../part$1"');
            
            document.getElementById('navigation-container').innerHTML = updatedHtml;
            
            // æ·»åŠ ç§»åŠ¨ç«¯èœå•åˆ‡æ¢åŠŸèƒ½
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.querySelector('.nav-menu');
            if (menuToggle && navMenu) {
                menuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                });
            }
        })
        .catch(error => console.error('å¯¼èˆªåŠ è½½å¤±è´¥:', error));
}

// é¡µé¢åŠ è½½å®ŒæˆååŠ è½½å¯¼èˆª
document.addEventListener('DOMContentLoaded', loadNavigation);
</script>



<main class="container">
        <!-- æ•°æ®é›†ä¸‹è½½åŒºåŸŸ -->
        <section class="lesson-content data-section">
            <h2>ğŸ“Š é…å¥—æ•°æ®é›†</h2>
            <div class="data-download-area">
                <div class="data-info">
                    <p>æœ¬è¯¾ç¨‹éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ•°æ®æ–‡ä»¶è¿›è¡Œæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒå’Œé¢„æµ‹ã€‚æ‚¨å¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚</p>
                </div>
                
                <div class="data-files-grid">
                    <div class="data-file-card">
                        <div class="file-header">
                            <span class="file-icon">ğŸ“ˆ</span>
                            <span class="file-name">stock_prices.csv</span>
                        </div>
                        <div class="file-description">
                            è‚¡ç¥¨ä»·æ ¼å†å²æ•°æ®ï¼Œç”¨äºä»·æ ¼é¢„æµ‹å’ŒæŠ€æœ¯åˆ†æç‰¹å¾æ„å»º
                        </div>
                        <div class="file-stats">
                            <span>ğŸ“Š 8åªè‚¡ç¥¨</span>
                            <span>ğŸ“… 2å¹´æ•°æ®</span>
                            <span>ğŸ’¾ ~274KB</span>
                        </div>
                        <button class="download-btn" onclick="downloadDataFile('stock_prices.csv')">
                            <span>â¬‡ï¸</span> ä¸‹è½½æ•°æ®æ–‡ä»¶
                        </button>
                    </div>
                    
                    <div class="data-file-card">
                        <div class="file-header">
                            <span class="file-icon">ğŸ’³</span>
                            <span class="file-name">credit_data.csv</span>
                        </div>
                        <div class="file-description">
                            ä¿¡ç”¨è¯„ä¼°æ•°æ®ï¼ŒåŒ…å«å®¢æˆ·ç‰¹å¾å’Œä¿¡ç”¨è¯„çº§ï¼Œç”¨äºä¿¡ç”¨é£é™©é¢„æµ‹æ¨¡å‹
                        </div>
                        <div class="file-stats">
                            <span>ğŸ“Š å®¢æˆ·æ•°æ®</span>
                            <span>ğŸ“ å¤šç‰¹å¾</span>
                            <span>ğŸ’¾ ~50KB</span>
                        </div>
                        <button class="download-btn" onclick="downloadDataFile('credit_data.csv')">
                            <span>â¬‡ï¸</span> ä¸‹è½½æ•°æ®æ–‡ä»¶
                        </button>
                    </div>
                </div>
                
                <div class="data-usage-tips">
                    <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
                    <ul>
                        <li>ä¸‹è½½æ‰€æœ‰æ•°æ®æ–‡ä»¶åˆ°æ‚¨çš„å·¥ä½œç›®å½•</li>
                        <li><code>stock_prices.csv</code> ç”¨äºè‚¡ç¥¨ä»·æ ¼é¢„æµ‹å’Œç‰¹å¾å·¥ç¨‹</li>
                        <li><code>credit_data.csv</code> ç”¨äºä¿¡ç”¨é£é™©åˆ†ç±»æ¨¡å‹è®­ç»ƒ</li>
                        <li>æ•°æ®ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼Œé€‚åˆå­¦ä¹ ç›‘ç£å­¦ä¹ ç®—æ³•</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="theory-section">
            <h2>ğŸ“š æ•°å­¦ç†è®ºåŸºç¡€</h2>
            <div class="theory-content">
                <h3>1. ç›‘ç£å­¦ä¹ çš„æ•°å­¦æ¡†æ¶</h3>
                <div class="math-formula">
                    <p><strong>ç›‘ç£å­¦ä¹ é—®é¢˜ï¼š</strong></p>
                    <p>ç»™å®šè®­ç»ƒé›† \(\mathcal{D} = \{(\mathbf{x}_i, y_i)\}_{i=1}^n\)ï¼Œå…¶ä¸­ \(\mathbf{x}_i \in \mathbb{R}^d\) æ˜¯ç‰¹å¾å‘é‡ï¼Œ\(y_i\) æ˜¯ç›®æ ‡å˜é‡ã€‚</p>
                    <p><strong>ç›®æ ‡ï¼š</strong>å­¦ä¹ æ˜ å°„å‡½æ•° \(f: \mathbb{R}^d \rightarrow \mathbb{R}\)ï¼Œä½¿å¾— \(f(\mathbf{x}) \approx y\)ã€‚</p>
                </div>
                <h3>2. æŸå¤±å‡½æ•°</h3>
                <div class="math-formula">
                    <p><strong>å‡æ–¹è¯¯å·®æŸå¤±ï¼ˆå›å½’ï¼‰ï¼š</strong></p>
                    <p>\[ L(y, \hat{y}) = \frac{1}{2}(y - \hat{y})^2 \]</p>
                    <p><strong>äº¤å‰ç†µæŸå¤±ï¼ˆåˆ†ç±»ï¼‰ï¼š</strong></p>
                    <p>\[ L(y, \hat{y}) = -y\log(\hat{y}) - (1-y)\log(1-\hat{y}) \]</p>
                </div>
                <h3>3. çº¿æ€§å›å½’</h3>
                <div class="math-formula">
                    <p><strong>æ¨¡å‹ï¼š</strong></p>
                    <p>\[ \hat{y} = \mathbf{w}^T\mathbf{x} + b = \sum_{j=1}^d w_j x_j + b \]</p>
                    <p><strong>æœ€å°äºŒä¹˜è§£ï¼š</strong></p>
                    <p>\[ \mathbf{w}^* = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y} \]</p>
                    <p>å…¶ä¸­ \(\mathbf{X} \in \mathbb{R}^{n \times d}\) æ˜¯è®¾è®¡çŸ©é˜µã€‚</p>
                </div>
                <h3>4. æ­£åˆ™åŒ–</h3>
                <div class="math-formula">
                    <p><strong>Ridgeå›å½’ï¼ˆL2æ­£åˆ™åŒ–ï¼‰ï¼š</strong></p>
                    <p>\[ J(\mathbf{w}) = \frac{1}{2n}\|\mathbf{X}\mathbf{w} - \mathbf{y}\|^2 + \lambda\|\mathbf{w}\|^2 \]</p>
                    <p><strong>Lassoå›å½’ï¼ˆL1æ­£åˆ™åŒ–ï¼‰ï¼š</strong></p>
                    <p>\[ J(\mathbf{w}) = \frac{1}{2n}\|\mathbf{X}\mathbf{w} - \mathbf{y}\|^2 + \lambda\|\mathbf{w}\|_1 \]</p>
                </div>
                <h3>5. é€»è¾‘å›å½’</h3>
                <div class="math-formula">
                    <p><strong>Sigmoidå‡½æ•°ï¼š</strong></p>
                    <p>\[ \sigma(z) = \frac{1}{1 + e^{-z}} \]</p>
                    <p><strong>æ¦‚ç‡æ¨¡å‹ï¼š</strong></p>
                    <p>\[ P(y=1|\mathbf{x}) = \sigma(\mathbf{w}^T\mathbf{x} + b) \]</p>
                    <p><strong>å¯¹æ•°ä¼¼ç„¶ï¼š</strong></p>
                    <p>\[ \ell(\mathbf{w}) = \sum_{i=1}^n [y_i \log p_i + (1-y_i) \log(1-p_i)] \]</p>
                </div>
                <h3>6. æ¢¯åº¦ä¸‹é™</h3>
                <div class="math-formula">
                    <p><strong>æ¢¯åº¦ä¸‹é™æ›´æ–°è§„åˆ™ï¼š</strong></p>
                    <p>\[ \mathbf{w}_{t+1} = \mathbf{w}_t - \eta \nabla J(\mathbf{w}_t) \]</p>
                    <p>å…¶ä¸­ \(\eta\) æ˜¯å­¦ä¹ ç‡ï¼Œ\(\nabla J(\mathbf{w}_t)\) æ˜¯æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€‚</p>
                </div>
                <h3>7. æ¨¡å‹è¯„ä¼°æŒ‡æ ‡</h3>
                <div class="math-formula">
                    <p><strong>å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰ï¼š</strong></p>
                    <p>\[ \text{RMSE} = \sqrt{\frac{1}{n}\sum_{i=1}^n (y_i - \hat{y}_i)^2} \]</p>
                    <p><strong>å†³å®šç³»æ•°ï¼ˆRÂ²ï¼‰ï¼š</strong></p>
                    <p>\[ R^2 = 1 - \frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{\sum_{i=1}^n (y_i - \bar{y})^2} \]</p>
                </div>
            </div>
        </section>
        <section class="lesson-content">
            <h2>ç‰¹å¾å·¥ç¨‹ä¸é€‰æ‹©</h2>
            <p>é‡‘èæ•°æ®ç‰¹å¾å·¥ç¨‹æ˜¯å°†åŸå§‹é‡‘èæ•°æ®è½¬æ¢ä¸ºé€‚åˆæœºå™¨å­¦ä¹ æ¨¡å‹è¾“å…¥çš„è¿‡ç¨‹ã€‚</p>
            <h3>1. é‡‘èæ—¶é—´åºåˆ—ç‰¹å¾æå–</h3>
            <pre><code class="language-python">import pandas as pd
import numpy as np
from tsfresh import extract_features
# åŠ è½½é‡‘èæ—¶é—´åºåˆ—æ•°æ®
data = pd.read_csv('stock_prices.csv', parse_dates=['date'])
data = data.sort_values('date')
# åŸºæœ¬ç‰¹å¾
data['log_return'] = np.log(data['close'] / data['close'].shift(1))
data['moving_avg_10'] = data['close'].rolling(window=10).mean()
data['volatility'] = data['log_return'].rolling(window=10).std()
# ä½¿ç”¨tsfreshæå–é«˜çº§ç‰¹å¾
extracted_features = extract_features(
    data.melt(id_vars='date'),
    column_id='date',
    column_sort='date',
    column_value='value',
    default_fc_parameters={
        'mean': None,
        'standard_deviation': None,
        'autocorrelation': [{'lag': 1}, {'lag': 5}]
    }
)</code></pre>
            <h3>2. ç‰¹å¾é€‰æ‹©æ–¹æ³•</h3>
            <pre><code class="language-python">from sklearn.feature_selection import SelectKBest, f_regression
from sklearn.ensemble import RandomForestRegressor
# å‡†å¤‡ç‰¹å¾çŸ©é˜µXå’Œç›®æ ‡å˜é‡y
X = extracted_features.fillna(0)
y = data['log_return'].values[10:]  # å¯¹é½ç‰¹å¾
# è¿‡æ»¤å¼ç‰¹å¾é€‰æ‹©
selector = SelectKBest(score_func=f_regression, k=10)
X_new = selector.fit_transform(X, y)
# åŸºäºæ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§
model = RandomForestRegressor()
model.fit(X, y)
importances = model.feature_importances_
important_features = X.columns[np.argsort(importances)[-10:]]</code></pre>
        </section>
        <section class="lesson-content">
            <h2>å›å½’ä¸åˆ†ç±»æ¨¡å‹</h2>
            <p>ç›‘ç£å­¦ä¹ æ¨¡å‹å¯åˆ†ä¸ºå›å½’æ¨¡å‹(é¢„æµ‹è¿ç»­å€¼)å’Œåˆ†ç±»æ¨¡å‹(é¢„æµ‹ç¦»æ•£ç±»åˆ«)ã€‚</p>
            <h3>1. é‡‘èæ—¶é—´åºåˆ—å›å½’</h3>
            <pre><code class="language-python">from sklearn.linear_model import Lasso
from sklearn.svm import SVR
from sklearn.model_selection import TimeSeriesSplit
# å‡†å¤‡æ•°æ®
X_train, X_test = X[:800], X[800:]
y_train, y_test = y[:800], y[800:]
# Lassoå›å½’
lasso = Lasso(alpha=0.1)
lasso.fit(X_train, y_train)
# æ”¯æŒå‘é‡å›å½’
svr = SVR(kernel='rbf', C=1.0, epsilon=0.1)
svr.fit(X_train, y_train)
# æ—¶é—´åºåˆ—äº¤å‰éªŒè¯
tscv = TimeSeriesSplit(n_splits=5)
for train_index, test_index in tscv.split(X):
    X_train, X_test = X.iloc[train_index], X.iloc[test_index]
    y_train, y_test = y[train_index], y[test_index]
    # è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹</code></pre>
            <h3>2. é‡‘èäº‹ä»¶åˆ†ç±»</h3>
            <pre><code class="language-python">from sklearn.ensemble import GradientBoostingClassifier
from sklearn.metrics import classification_report
# åˆ›å»ºåˆ†ç±»æ ‡ç­¾(ä¾‹å¦‚: æ¶¨è·Œåˆ†ç±»)
y_class = np.where(y > 0, 1, 0)
# æ¢¯åº¦æå‡æ ‘åˆ†ç±»å™¨
clf = GradientBoostingClassifier(n_estimators=100, learning_rate=0.1)
clf.fit(X_train, y_train[:800])
# é¢„æµ‹ä¸è¯„ä¼°
y_pred = clf.predict(X_test)
print(classification_report(y_test[800:], y_pred))</code></pre>
        </section>
        <section class="lesson-content">
            <h2>æ¨¡å‹è¯„ä¼°ä¸éªŒè¯</h2>
            <p>é‡‘èæœºå™¨å­¦ä¹ æ¨¡å‹éœ€è¦ç‰¹æ®Šçš„è¯„ä¼°æ–¹æ³•å’ŒéªŒè¯ç­–ç•¥ã€‚</p>
            <h3>1. é‡‘èæ¨¡å‹è¯„ä¼°æŒ‡æ ‡</h3>
            <pre><code class="language-python">def sharpe_ratio(returns, risk_free_rate=0.0):
    """è®¡ç®—å¤æ™®æ¯”ç‡"""
    excess_returns = returns - risk_free_rate
    return np.mean(excess_returns) / np.std(excess_returns)
def maximum_drawdown(returns):
    """è®¡ç®—æœ€å¤§å›æ’¤"""
    cumulative = np.cumsum(returns)
    peak = np.maximum.accumulate(cumulative)
    drawdown = (peak - cumulative) / peak
    return np.max(drawdown)
# æ¨¡å‹é¢„æµ‹æ”¶ç›Šè¯„ä¼°
model_returns = y_test * y_pred  # å‡è®¾y_predæ˜¯äº¤æ˜“ä¿¡å·
print(f"å¤æ™®æ¯”ç‡: {sharpe_ratio(model_returns):.2f}")
print(f"æœ€å¤§å›æ’¤: {maximum_drawdown(model_returns):.2%}")</code></pre>
            <h3>2. äº¤å‰éªŒè¯ç­–ç•¥</h3>
            <pre><code class="language-python">from sklearn.model_selection import TimeSeriesSplit
from sklearn.metrics import make_scorer
# æ—¶é—´åºåˆ—äº¤å‰éªŒè¯
tscv = TimeSeriesSplit(n_splits=5)
# è‡ªå®šä¹‰è¯„åˆ†å‡½æ•°
def financial_score(y_true, y_pred):
    returns = y_true * y_pred
    return sharpe_ratio(returns)
financial_scorer = make_scorer(financial_score, greater_is_better=True)
# æ¨¡å‹é€‰æ‹©ä¸è¯„ä¼°
from sklearn.model_selection import GridSearchCV
param_grid = {'alpha': [0.1, 0.5, 1.0]}
grid_search = GridSearchCV(Lasso(), param_grid, cv=tscv, scoring=financial_scorer)
grid_search.fit(X, y)</code></pre>
        </section>
        <section class="lesson-content">
            <h2>ç®—æ³•å¤æ‚åº¦åˆ†æ</h2>
            <p>äº†è§£ä¸åŒæœºå™¨å­¦ä¹ ç®—æ³•çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å¯¹äºé‡‘èåº”ç”¨è‡³å…³é‡è¦ã€‚</p>
            <div id="algorithm-complexity-demo"></div>
            <h3>1. çº¿æ€§å›å½’å¤æ‚åº¦</h3>
            <pre><code class="language-python"># çº¿æ€§å›å½’ç®—æ³•å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(n*d^2 + d^3) - å…¶ä¸­næ˜¯æ ·æœ¬æ•°ï¼Œdæ˜¯ç‰¹å¾æ•°
# ç©ºé—´å¤æ‚åº¦: O(n*d + d^2)
from sklearn.linear_model import LinearRegression
import time
def analyze_linear_regression_complexity(n_samples, n_features):
    """åˆ†æçº¿æ€§å›å½’çš„å¤æ‚åº¦"""
    X = np.random.randn(n_samples, n_features)
    y = np.random.randn(n_samples)
    start_time = time.time()
    model = LinearRegression()
    model.fit(X, y)
    training_time = time.time() - start_time
    print(f"æ ·æœ¬æ•°: {n_samples}, ç‰¹å¾æ•°: {n_features}")
    print(f"è®­ç»ƒæ—¶é—´: {training_time:.4f}ç§’")
    print(f"ç†è®ºå¤æ‚åº¦: O({n_samples}*{n_features}^2 + {n_features}^3)")
    return training_time</code></pre>
            <h3>2. éšæœºæ£®æ—å¤æ‚åº¦</h3>
            <pre><code class="language-python"># éšæœºæ£®æ—ç®—æ³•å¤æ‚åº¦åˆ†æ
# æ—¶é—´å¤æ‚åº¦: O(n*log(n)*d*k) - å…¶ä¸­kæ˜¯æ ‘çš„æ•°é‡
# ç©ºé—´å¤æ‚åº¦: O(k*n)
from sklearn.ensemble import RandomForestRegressor
def analyze_random_forest_complexity(n_samples, n_features, n_estimators=100):
    """åˆ†æéšæœºæ£®æ—çš„å¤æ‚åº¦"""
    X = np.random.randn(n_samples, n_features)
    y = np.random.randn(n_samples)
    start_time = time.time()
    model = RandomForestRegressor(n_estimators=n_estimators)
    model.fit(X, y)
    training_time = time.time() - start_time
    print(f"éšæœºæ£®æ— - æ ·æœ¬æ•°: {n_samples}, ç‰¹å¾æ•°: {n_features}, æ ‘æ•°é‡: {n_estimators}")
    print(f"è®­ç»ƒæ—¶é—´: {training_time:.4f}ç§’")
    print(f"ç†è®ºå¤æ‚åº¦: O({n_samples}*log({n_samples})*{n_features}*{n_estimators})")
    return training_time</code></pre>
            <h3>3. å‚æ•°æ•æ„Ÿæ€§åˆ†æ</h3>
            <div id="parameter-sensitivity-demo"></div>
            <h2>æ·±åº¦å­¦ä¹ æ‰©å±•</h2>
            <p>å¯¹äºæ›´å¤æ‚çš„é‡‘èé¢„æµ‹ä»»åŠ¡ï¼Œæ·±åº¦å­¦ä¹ æä¾›äº†å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆã€‚</p>
            <div class="feature-highlight">
                <h3>ğŸ§  æ¢ç´¢æ·±åº¦å­¦ä¹ åœ¨é‡‘èä¸­çš„åº”ç”¨</h3>
                <p>å­¦ä¹ ç¥ç»ç½‘ç»œã€LSTMã€CNNç­‰æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨é‡‘èé¢„æµ‹ã€é£é™©ç®¡ç†å’Œç®—æ³•äº¤æ˜“ä¸­çš„åº”ç”¨ã€‚</p>
                <a href="../../../deep_learning_finance.html" class="btn btn-large">è¿›å…¥æ·±åº¦å­¦ä¹ æ¨¡å— â†’</a>
            </div>
            <h2>é‡‘èé¢„æµ‹æ¡ˆä¾‹</h2>
            <p>å®é™…é‡‘èé¢„æµ‹æ¡ˆä¾‹å±•ç¤ºå®Œæ•´çš„æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ã€‚</p>
            <h3>1. è‚¡ç¥¨æ”¶ç›Šé¢„æµ‹</h3>
            <pre><code class="language-python"># å®Œæ•´å·¥ä½œæµç¨‹ç¤ºä¾‹
import yfinance as yf
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
# è·å–æ•°æ®
ticker = yf.Ticker("AAPL")
data = ticker.history(period="5y")
# ç‰¹å¾å·¥ç¨‹
data['Return'] = data['Close'].pct_change()
features = data[['Open', 'High', 'Low', 'Close', 'Volume']].shift(1)
target = data['Return']
# æ„å»ºç®¡é“
pipeline = Pipeline([
    ('scaler', StandardScaler()),
    ('model', Lasso())
])
# è®­ç»ƒä¸é¢„æµ‹
pipeline.fit(features.dropna(), target.dropna())
predictions = pipeline.predict(features)</code></pre>
            <h3>2. ä¿¡ç”¨é£é™©è¯„ä¼°</h3>
            <pre><code class="language-python">from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import roc_auc_score
# åŠ è½½ä¿¡ç”¨æ•°æ®
credit_data = pd.read_csv('credit_data.csv')
# é¢„å¤„ç†
X = credit_data.drop('default', axis=1)
y = credit_data['default']
# æ¨¡å‹è®­ç»ƒ
model = RandomForestClassifier()
model.fit(X, y)
# è¯„ä¼°
probabilities = model.predict_proba(X)[:, 1]
print(f"AUCåˆ†æ•°: {roc_auc_score(y, probabilities):.2f}")</code></pre>
        </section>
        <div class="lesson-navigation">
            <a href="../../index.html" class="btn">Â« è¿”å›æ¨¡å—é¦–é¡µ</a>
            <a href="lesson2.html" class="btn">ä¸‹ä¸€è¯¾: æ— ç›‘ç£å­¦ä¹ åœ¨é‡‘èä¸­çš„åº”ç”¨ Â»</a>
        </div>
    </main>
    <footer>
        <div class="container">
            <p>Â© 2023 Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>

<style>
/* æ•°æ®é›†ä¸‹è½½åŒºåŸŸæ ·å¼ */
.data-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.data-section h2 {
    color: white;
    text-align: center;
    margin-bottom: 25px;
    font-size: 2em;
}

.data-download-area {
    max-width: 1000px;
    margin: 0 auto;
}

.data-info {
    text-align: center;
    margin-bottom: 30px;
    font-size: 1.1em;
    opacity: 0.9;
}

.data-files-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.data-file-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 25px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.data-file-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.2);
}

.file-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.file-icon {
    font-size: 2em;
    margin-right: 15px;
}

.file-name {
    font-size: 1.3em;
    font-weight: bold;
    color: #fff;
}

.file-description {
    margin-bottom: 15px;
    line-height: 1.6;
    opacity: 0.9;
}

.file-stats {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.file-stats span {
    background: rgba(255, 255, 255, 0.2);
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.9em;
    white-space: nowrap;
}

.download-btn {
    background: linear-gradient(45deg, #4CAF50, #45a049);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1em;
    font-weight: bold;
    width: 100%;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
}

.download-btn:hover {
    background: linear-gradient(45deg, #45a049, #4CAF50);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
}

.download-btn:active {
    transform: translateY(0);
}

.data-usage-tips {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 25px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.data-usage-tips h4 {
    margin-bottom: 15px;
    color: #fff;
    font-size: 1.2em;
}

.data-usage-tips ul {
    list-style: none;
    padding: 0;
}

.data-usage-tips li {
    margin-bottom: 10px;
    padding-left: 20px;
    position: relative;
    line-height: 1.6;
}

.data-usage-tips li:before {
    content: "âœ“";
    position: absolute;
    left: 0;
    color: #4CAF50;
    font-weight: bold;
}

.data-usage-tips code {
    background: rgba(0, 0, 0, 0.3);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    color: #fff;
}

/* ä¸‹è½½é€šçŸ¥æ ·å¼ */
.download-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: #4CAF50;
    color: white;
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.3s ease;
}

.download-notification.show {
    opacity: 1;
    transform: translateX(0);
}

@media (max-width: 768px) {
    .data-files-grid {
        grid-template-columns: 1fr;
    }
    
    .file-stats {
        justify-content: center;
    }
    
    .data-section {
        padding: 20px;
        margin: 15px;
        border-radius: 10px;
    }
}
</style>

<script>
function downloadDataFile(filename) {
    let csvContent = '';
    
    if (filename === 'stock_prices.csv') {
        // ç”Ÿæˆè‚¡ç¥¨ä»·æ ¼æ•°æ®
        const headers = ['Date', 'AAPL', 'GOOGL', 'MSFT', 'AMZN', 'TSLA', 'META', 'NVDA', 'NFLX'];
        csvContent = headers.join(',') + '\n';
        
        const startDate = new Date('2022-01-01');
        const endDate = new Date('2023-12-31');
        const prices = {
            'AAPL': 150, 'GOOGL': 2800, 'MSFT': 330, 'AMZN': 3300,
            'TSLA': 1000, 'META': 350, 'NVDA': 220, 'NFLX': 500
        };
        
        for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
            if (d.getDay() !== 0 && d.getDay() !== 6) { // è·³è¿‡å‘¨æœ«
                const dateStr = d.toISOString().split('T')[0];
                const row = [dateStr];
                
                for (let i = 1; i < headers.length; i++) {
                    const symbol = headers[i];
                    const change = (Math.random() - 0.5) * 0.05; // Â±2.5%çš„éšæœºå˜åŒ–
                    prices[symbol] *= (1 + change);
                    row.push(prices[symbol].toFixed(2));
                }
                
                csvContent += row.join(',') + '\n';
            }
        }
    } else if (filename === 'credit_data.csv') {
        // ç”Ÿæˆä¿¡ç”¨æ•°æ®
        const headers = ['customer_id', 'age', 'income', 'credit_score', 'debt_ratio', 'employment_years', 'loan_amount', 'credit_rating'];
        csvContent = headers.join(',') + '\n';
        
        for (let i = 1; i <= 1000; i++) {
            const age = Math.floor(Math.random() * 50) + 25;
            const income = Math.floor(Math.random() * 80000) + 30000;
            const creditScore = Math.floor(Math.random() * 300) + 500;
            const debtRatio = (Math.random() * 0.6).toFixed(2);
            const employmentYears = Math.floor(Math.random() * 20) + 1;
            const loanAmount = Math.floor(Math.random() * 50000) + 5000;
            
            // åŸºäºå…¶ä»–ç‰¹å¾ç”Ÿæˆä¿¡ç”¨è¯„çº§
            let rating;
            const score = (creditScore - 500) / 300 * 0.4 + 
                         (income - 30000) / 80000 * 0.3 + 
                         (1 - parseFloat(debtRatio)) * 0.3;
            
            if (score > 0.7) rating = 'A';
            else if (score > 0.5) rating = 'B';
            else if (score > 0.3) rating = 'C';
            else rating = 'D';
            
            const row = [i, age, income, creditScore, debtRatio, employmentYears, loanAmount, rating];
            csvContent += row.join(',') + '\n';
        }
    }
    
    // åˆ›å»ºä¸‹è½½é“¾æ¥
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', filename);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    // æ˜¾ç¤ºä¸‹è½½é€šçŸ¥
    showDownloadNotification(filename);
}

function showDownloadNotification(filename) {
    // ç§»é™¤ç°æœ‰é€šçŸ¥
    const existingNotification = document.querySelector('.download-notification');
    if (existingNotification) {
        existingNotification.remove();
    }
    
    // åˆ›å»ºæ–°é€šçŸ¥
    const notification = document.createElement('div');
    notification.className = 'download-notification';
    notification.innerHTML = `âœ… ${filename} ä¸‹è½½å®Œæˆï¼`;
    document.body.appendChild(notification);
    
    // æ˜¾ç¤ºé€šçŸ¥
    setTimeout(() => {
        notification.classList.add('show');
    }, 100);
    
    // 3ç§’åéšè—é€šçŸ¥
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}
</script>

</body>
</html>
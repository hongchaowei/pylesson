<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3è¯¾: Plotlyäº¤äº’å¼å¯è§†åŒ– - Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹</title>
    <link rel="stylesheet" href="../../css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <style>
    /* ç¡®ä¿ä»£ç å—å·¦å¯¹é½ */
    .lesson-content pre {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
        border-left: 4px solid #4299e1;
    }
    
    .lesson-content code {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 2px 5px;
        border-radius: 3px;
    }
    
    /* ç¡®ä¿preæ ‡ç­¾å†…çš„å†…å®¹å·¦å¯¹é½ */
    pre * {
        text-align: left !important;
    }
    
    /* ç¡®ä¿æ‰€æœ‰ä»£ç ç›¸å…³å…ƒç´ éƒ½å·¦å¯¹é½ */
    pre, code, .hljs {
        text-align: left !important;
    }
    </style>
    
</head>
<body>
<div id="navigation-container"></div>
<script>
// åŠ¨æ€åŠ è½½å¯¼èˆªæ¡
function loadNavigation() {
    fetch('../../nav.html')
        .then(response => response.text())
        .then(html => {
            // æ›´æ–°å¯¼èˆªä¸­çš„é“¾æ¥è·¯å¾„
            let updatedHtml = html;
            
            // å¤„ç†æ ¹ç›®å½•æ–‡ä»¶é“¾æ¥ï¼ˆindex.html, syllabus.htmlç­‰ï¼‰
            updatedHtml = updatedHtml.replace(/href="index\.html"/g, 'href="../../index.html"');
            updatedHtml = updatedHtml.replace(/href="\.\/([^/]*\.html)"/g, 'href="../../$1"');
            
            // å¤„ç†æ¨¡å—è·¯å¾„é“¾æ¥ï¼ˆå·²ç»æ˜¯å®Œæ•´ç›¸å¯¹è·¯å¾„ï¼Œåªéœ€è¦æ·»åŠ æ ¹è·¯å¾„å‰ç¼€ï¼‰
            updatedHtml = updatedHtml.replace(/href="\.\/part([^"]*)"/g, 'href="../../part$1"');
            
            document.getElementById('navigation-container').innerHTML = updatedHtml;
            
            // æ·»åŠ ç§»åŠ¨ç«¯èœå•åˆ‡æ¢åŠŸèƒ½
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.querySelector('.nav-menu');
            if (menuToggle && navMenu) {
                menuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                });
            }
        })
        .catch(error => console.error('å¯¼èˆªåŠ è½½å¤±è´¥:', error));
}

// é¡µé¢åŠ è½½å®ŒæˆååŠ è½½å¯¼èˆª
document.addEventListener('DOMContentLoaded', loadNavigation);
</script>



<main class="container">
        <!-- æ•°æ®é›†ä¸‹è½½åŒºåŸŸ -->
        <section class="lesson-content data-section">
            <h2>ğŸ“Š é…å¥—æ•°æ®é›†</h2>
            <div class="data-download-area">
                <div class="data-info">
                    <p>æœ¬è¯¾ç¨‹éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ•°æ®æ–‡ä»¶è¿›è¡ŒPlotlyäº¤äº’å¼å¯è§†åŒ–ç»ƒä¹ ã€‚æ‚¨å¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚</p>
                </div>
                
                <div class="data-files-grid">
                    <div class="data-file-card">
                        <div class="file-header">
                            <span class="file-icon">ğŸ“ˆ</span>
                            <span class="file-name">stock_data.csv</span>
                        </div>
                        <div class="file-description">
                            è‚¡ç¥¨ç»¼åˆæ•°æ®ï¼ŒåŒ…å«ä»·æ ¼ã€æˆäº¤é‡ã€æŠ€æœ¯æŒ‡æ ‡ç­‰ï¼Œç”¨äºåˆ›å»ºäº¤äº’å¼é‡‘èå›¾è¡¨
                        </div>
                        <div class="file-stats">
                            <span>ğŸ“Š å¤šåªè‚¡ç¥¨</span>
                            <span>ğŸ“… å†å²æ•°æ®</span>
                            <span>ğŸ’¾ ~180KB</span>
                        </div>
                        <button class="download-btn" onclick="downloadDataFile('stock_data.csv')">
                            <span>â¬‡ï¸</span> ä¸‹è½½æ•°æ®æ–‡ä»¶
                        </button>
                    </div>
                </div>
                
                <div class="data-usage-tips">
                    <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
                    <ul>
                        <li>ä¸‹è½½æ•°æ®æ–‡ä»¶åˆ°æ‚¨çš„å·¥ä½œç›®å½•</li>
                        <li><code>stock_data.csv</code> ç”¨äºåˆ›å»ºèœ¡çƒ›å›¾ã€OHLCå›¾å’ŒæŠ€æœ¯æŒ‡æ ‡å›¾è¡¨</li>
                        <li>æ•°æ®åŒ…å«å¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æ”¶ç›˜ä»·å’Œæˆäº¤é‡</li>
                        <li>é€‚åˆç»ƒä¹ Plotlyçš„å„ç§äº¤äº’å¼å¯è§†åŒ–åŠŸèƒ½</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="lesson-content">
            <h2>Plotlyç®€ä»‹</h2>
            <p>Plotlyæ˜¯Pythonä¸­æœ€å¼ºå¤§çš„äº¤äº’å¼å¯è§†åŒ–åº“ï¼Œç‰¹åˆ«é€‚åˆåˆ›å»ºé‡‘èæ•°æ®ä»ªè¡¨æ¿å’Œåˆ†æå·¥å…·ã€‚</p>
            <h3>æ ¸å¿ƒä¼˜åŠ¿</h3>
            <ul>
                <li>ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ï¼šç¼©æ”¾ã€å¹³ç§»ã€æ‚¬åœæç¤º</li>
                <li>ä¸“ä¸šçº§çš„é‡‘èå›¾è¡¨ï¼šèœ¡çƒ›å›¾ã€OHLCå›¾ã€æŠ€æœ¯æŒ‡æ ‡</li>
                <li>å“åº”å¼è®¾è®¡ï¼šè‡ªåŠ¨é€‚åº”ä¸åŒè®¾å¤‡</li>
                <li>å¤šç§è¾“å‡ºæ ¼å¼ï¼šHTMLã€Jupyter Notebookã€Dashåº”ç”¨</li>
            </ul>
            <pre><code class="language-python">import plotly.graph_objects as go
import plotly.express as px
import pandas as pd
# è®¾ç½®æ¨¡æ¿
template = "plotly_white"</code></pre>
        </section>
        <section class="lesson-content">
            <h2>åŸºç¡€äº¤äº’å¼å›¾è¡¨</h2>
            <h3>1. äº¤äº’å¼çº¿å›¾</h3>
            <pre><code class="language-python"># åˆ›å»ºç¤ºä¾‹æ•°æ®
dates = pd.date_range('2023-01-01', periods=50)
prices = (1 + pd.Series(np.random.randn(50) * 0.01).cumsum()) * 100
# åˆ›å»ºçº¿å›¾
fig = go.Figure()
fig.add_trace(go.Scatter(
    x=dates, y=prices,
    mode='lines',
    name='AAPL',
    line=dict(color='royalblue', width=2),
    hovertemplate='æ—¥æœŸ: %{x}<br>ä»·æ ¼: $%{y:.2f}<extra></extra>'
))
# æ›´æ–°å¸ƒå±€
fig.update_layout(
    title='AAPLä»·æ ¼èµ°åŠ¿(äº¤äº’å¼)',
    xaxis_title='æ—¥æœŸ',
    yaxis_title='ä»·æ ¼',
    template=template,
    hovermode='x unified'
)
fig.show()</code></pre>
            <h3>2. äº¤äº’å¼æŸ±çŠ¶å›¾</h3>
            <pre><code class="language-python"># åˆ›å»ºç¤ºä¾‹æ•°æ®
stocks = ['AAPL', 'MSFT', 'GOOG', 'AMZN']
returns = np.random.uniform(-0.1, 0.15, 4)
# åˆ›å»ºæŸ±çŠ¶å›¾
fig = go.Figure()
fig.add_trace(go.Bar(
    x=stocks, y=returns,
    marker_color=np.where(returns > 0, 'green', 'red'),
    text=[f'{r:.2%}' for r in returns],
    textposition='auto'
))
# æ›´æ–°å¸ƒå±€
fig.update_layout(
    title='è‚¡ç¥¨æ”¶ç›Šç‡æ¯”è¾ƒ',
    yaxis_title='æ”¶ç›Šç‡',
    template=template
)
fig.show()</code></pre>
            <h3>3. äº¤äº’å¼æ•£ç‚¹å›¾</h3>
            <pre><code class="language-python"># åˆ›å»ºç¤ºä¾‹æ•°æ®
np.random.seed(42)
volatility = np.random.uniform(0.1, 0.4, 20)
returns = volatility * 0.5 + np.random.normal(0, 0.05, 20)
sharpe = returns / volatility
symbols = [f'Stock_{i}' for i in range(20)]
# åˆ›å»ºæ•£ç‚¹å›¾
fig = px.scatter(
    x=volatility, y=returns,
    color=sharpe, size=np.abs(returns)*100,
    hover_name=symbols,
    labels={'x': 'æ³¢åŠ¨ç‡', 'y': 'æ”¶ç›Šç‡'},
    title='é£é™©-å›æŠ¥åˆ†æ'
)
fig.update_layout(template=template)
fig.show()</code></pre>
        </section>
        <section class="lesson-content">
            <h2>é‡‘èä¸“ç”¨å›¾è¡¨</h2>
            <h3>1. èœ¡çƒ›å›¾ (Candlestick Chart)</h3>
            <pre><code class="language-python"># åˆ›å»ºç¤ºä¾‹OHLCæ•°æ®
np.random.seed(42)
dates = pd.date_range('2023-01-01', periods=20)
open_prices = np.cumsum(np.random.randn(20) * 0.5) + 100
high = open_prices + np.random.uniform(0.5, 2.0, 20)
low = open_prices - np.random.uniform(0.5, 2.0, 20)
close = open_prices + np.random.randn(20) * 0.2
# åˆ›å»ºèœ¡çƒ›å›¾
fig = go.Figure(data=[go.Candlestick(
    x=dates,
    open=open_prices,
    high=high,
    low=low,
    close=close,
    increasing_line_color='green',
    decreasing_line_color='red'
)])
# æ›´æ–°å¸ƒå±€
fig.update_layout(
    title='AAPLèœ¡çƒ›å›¾',
    yaxis_title='ä»·æ ¼',
    xaxis_rangeslider_visible=False,
    template=template
)
fig.show()</code></pre>
            <h3>2. OHLCå›¾</h3>
            <pre><code class="language-python">fig = go.Figure(data=[go.Ohlc(
    x=dates,
    open=open_prices,
    high=high,
    low=low,
    close=close,
    increasing_line_color='green',
    decreasing_line_color='red'
)])
fig.update_layout(
    title='AAPL OHLCå›¾',
    yaxis_title='ä»·æ ¼',
    template=template
)
fig.show()</code></pre>
        </section>
        <section class="lesson-content">
            <h2>æŠ€æœ¯æŒ‡æ ‡å¯è§†åŒ–</h2>
            <h3>1. MACDæŒ‡æ ‡</h3>
            <pre><code class="language-python"># è®¡ç®—MACD
def calculate_macd(prices, slow=26, fast=12, signal=9):
    ema_fast = prices.ewm(span=fast).mean()
    ema_slow = prices.ewm(span=slow).mean()
    macd = ema_fast - ema_slow
    signal_line = macd.ewm(span=signal).mean()
    histogram = macd - signal_line
    return macd, signal_line, histogram
macd, signal, hist = calculate_macd(pd.Series(close))
# åˆ›å»ºä¸»å›¾(ä»·æ ¼)
fig = go.Figure()
fig.add_trace(go.Scatter(
    x=dates, y=close,
    name='æ”¶ç›˜ä»·',
    line=dict(color='royalblue', width=2)
))
# åˆ›å»ºMACDå­å›¾
fig.add_trace(go.Scatter(
    x=dates, y=macd,
    name='MACD',
    line=dict(color='orange', width=2),
    yaxis='y2'
))
fig.add_trace(go.Scatter(
    x=dates, y=signal,
    name='ä¿¡å·çº¿',
    line=dict(color='green', width=1),
    yaxis='y2'
))
fig.add_trace(go.Bar(
    x=dates, y=hist,
    name='ç›´æ–¹å›¾',
    marker_color=np.where(hist > 0, 'green', 'red'),
    yaxis='y2'
))
# æ›´æ–°å¸ƒå±€
fig.update_layout(
    title='AAPLä»·æ ¼ä¸MACDæŒ‡æ ‡',
    yaxis=dict(title='ä»·æ ¼'),
    yaxis2=dict(
        title='MACD',
        overlaying='y',
        side='right'
    ),
    template=template,
    hovermode='x unified'
)
fig.show()</code></pre>
            <h3>2. RSIæŒ‡æ ‡</h3>
            <pre><code class="language-python"># è®¡ç®—RSI
def calculate_rsi(prices, window=14):
    delta = prices.diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window).mean()
    avg_loss = loss.rolling(window).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    return rsi
rsi = calculate_rsi(pd.Series(close))
# åˆ›å»ºä¸»å›¾(ä»·æ ¼)
fig = go.Figure()
fig.add_trace(go.Scatter(
    x=dates, y=close,
    name='æ”¶ç›˜ä»·',
    line=dict(color='royalblue', width=2),
    yaxis='y'
))
# åˆ›å»ºRSIå­å›¾
fig.add_trace(go.Scatter(
    x=dates, y=rsi,
    name='RSI',
    line=dict(color='purple', width=2),
    yaxis='y2'
))
# æ·»åŠ è¶…ä¹°è¶…å–çº¿
fig.add_hline(y=70, line_dash="dot", line_color="red", yref="y2")
fig.add_hline(y=30, line_dash="dot", line_color="green", yref="y2")
# æ›´æ–°å¸ƒå±€
fig.update_layout(
    title='AAPLä»·æ ¼ä¸RSIæŒ‡æ ‡',
    yaxis=dict(title='ä»·æ ¼'),
    yaxis2=dict(
        title='RSI',
        overlaying='y',
        side='right',
        range=[0, 100]
    ),
    template=template
)
fig.show()</code></pre>
        </section>
        <div class="lesson-navigation">
            <a href="lesson2.html" class="btn">Â« ä¸Šä¸€è¯¾: Seaborné«˜çº§å¯è§†åŒ–</a>
            <a href="lesson4.html" class="btn">ä¸‹ä¸€è¯¾: é‡‘èæ•°æ®ä¸“ç”¨å›¾è¡¨ Â»</a>
        </div>
    </main>
    <footer>
        <div class="container">
            <p>Â© 2023 Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>
</body>
</html>
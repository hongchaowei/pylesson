<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾ç¨‹1: PandasåŸºç¡€ - Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹</title>
    <link rel="stylesheet" href="../../css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
    /* ç¡®ä¿ä»£ç å—å·¦å¯¹é½ */
    .lesson-content pre {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
        border-left: 4px solid #4299e1;
    }
    
    .lesson-content code {
        text-align: left !important;
        font-family: 'Courier New', Courier, monospace;
        background-color: #f5f7fa;
        padding: 2px 5px;
        border-radius: 3px;
    }
    
    /* ç¡®ä¿preæ ‡ç­¾å†…çš„å†…å®¹å·¦å¯¹é½ */
    pre * {
        text-align: left !important;
    }
    
    /* ç¡®ä¿æ‰€æœ‰ä»£ç ç›¸å…³å…ƒç´ éƒ½å·¦å¯¹é½ */
    pre, code, .hljs {
        text-align: left !important;
    }
    
    /* äº¤äº’å¼æ¼”ç¤ºæ ·å¼ */
    .interactive-demo {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 15px;
        margin: 25px 0;
        box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
    }
    
    .demo-controls {
        display: flex;
        gap: 15px;
        margin: 15px 0;
        flex-wrap: wrap;
    }
    
    .demo-button {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 2px solid rgba(255,255,255,0.3);
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
    }
    
    .demo-button:hover {
        background: rgba(255,255,255,0.3);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .chart-container {
        background: white;
        border-radius: 10px;
        padding: 20px;
        margin: 15px 0;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .data-table {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin: 10px 0;
        overflow-x: auto;
    }
    
    .data-table table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9em;
    }
    
    .data-table th, .data-table td {
        padding: 8px 12px;
        text-align: left;
        border-bottom: 1px solid #eee;
        color: #333;
    }
    
    .data-table th {
        background: #f8f9fa;
        font-weight: 600;
        color: #495057;
    }
    
    .tooltip {
        position: absolute;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s;
    }
    </style>
    
</head>
<body>
<div id="navigation-container"></div>
<script>
// åŠ¨æ€åŠ è½½å¯¼èˆªæ¡
function loadNavigation() {
    fetch('../../nav.html')
        .then(response => response.text())
        .then(html => {
            // æ›´æ–°å¯¼èˆªä¸­çš„é“¾æ¥è·¯å¾„
            let updatedHtml = html;
            
            // å¤„ç†æ ¹ç›®å½•æ–‡ä»¶é“¾æ¥ï¼ˆindex.html, syllabus.htmlç­‰ï¼‰
            updatedHtml = updatedHtml.replace(/href="index\.html"/g, 'href="../../index.html"');
            updatedHtml = updatedHtml.replace(/href="\.\/([^/]*\.html)"/g, 'href="../../$1"');
            
            // å¤„ç†æ¨¡å—è·¯å¾„é“¾æ¥ï¼ˆå·²ç»æ˜¯å®Œæ•´ç›¸å¯¹è·¯å¾„ï¼Œåªéœ€è¦æ·»åŠ æ ¹è·¯å¾„å‰ç¼€ï¼‰
            updatedHtml = updatedHtml.replace(/href="\.\/part([^"]*)"/g, 'href="../../part$1"');
            
            document.getElementById('navigation-container').innerHTML = updatedHtml;
            
            // æ·»åŠ ç§»åŠ¨ç«¯èœå•åˆ‡æ¢åŠŸèƒ½
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.querySelector('.nav-menu');
            if (menuToggle && navMenu) {
                menuToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                });
            }
        })
        .catch(error => console.error('å¯¼èˆªåŠ è½½å¤±è´¥:', error));
}

// é¡µé¢åŠ è½½å®ŒæˆååŠ è½½å¯¼èˆª
document.addEventListener('DOMContentLoaded', loadNavigation);
</script>



    

<main class="container">
        <section class="lesson-content">
            <h2>ä»€ä¹ˆæ˜¯Pandasï¼Ÿ</h2>
            <p>Pandasæ˜¯Pythonä¸­æœ€æµè¡Œçš„æ•°æ®åˆ†æåº“ï¼Œä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†è¡¨æ ¼æ•°æ®å’Œæ—¶é—´åºåˆ—ã€‚å®ƒæ„å»ºåœ¨NumPyä¹‹ä¸Šï¼Œæä¾›äº†æ›´é«˜çº§çš„æ•°æ®ç»“æ„å’Œæ“ä½œï¼Œç‰¹åˆ«é€‚åˆé‡‘èæ•°æ®åˆ†æã€‚</p>
            <h3>Pandasçš„ä¸»è¦ç‰¹ç‚¹</h3>
            <ul>
                <li><strong>ä¸¤ç§æ ¸å¿ƒæ•°æ®ç»“æ„</strong>ï¼šSeriesï¼ˆä¸€ç»´ï¼‰å’ŒDataFrameï¼ˆäºŒç»´ï¼‰</li>
                <li><strong>æ•°æ®å¯¹é½</strong>ï¼šè‡ªåŠ¨å¤„ç†ä¸åŒæ•°æ®æºçš„æ•°æ®å¯¹é½é—®é¢˜</li>
                <li><strong>å¤„ç†ç¼ºå¤±æ•°æ®</strong>ï¼šæä¾›çµæ´»çš„æ–¹æ³•å¤„ç†NaNå€¼</li>
                <li><strong>å¼ºå¤§çš„IOå·¥å…·</strong>ï¼šæ”¯æŒä»CSVã€Excelã€SQLç­‰å¤šç§æ•°æ®æºåŠ è½½æ•°æ®</li>
                <li><strong>æ—¶é—´åºåˆ—åŠŸèƒ½</strong>ï¼šä¸“é—¨ä¸ºé‡‘èæ—¶é—´åºåˆ—åˆ†æè®¾è®¡çš„åŠŸèƒ½</li>
            </ul>
            <h3>Pandasåœ¨é‡‘èä¸­çš„åº”ç”¨</h3>
            <ul>
                <li>é‡‘èæ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†</li>
                <li>æ—¶é—´åºåˆ—åˆ†æå’Œå¤„ç†</li>
                <li>æ”¶ç›Šç‡è®¡ç®—å’Œé£é™©åˆ†æ</li>
                <li>æŠ•èµ„ç»„åˆæ„å»ºå’Œè¯„ä¼°</li>
                <li>é‡åŒ–äº¤æ˜“ç­–ç•¥å›æµ‹</li>
            </ul>
        </section>
        <section class="lesson-content">
            <h2>å®‰è£…Pandas</h2>
            <p>åœ¨å¼€å§‹ä½¿ç”¨Pandasä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®‰è£…å®ƒã€‚Pandaså¯ä»¥é€šè¿‡pipæˆ–condaå®‰è£…ã€‚</p>
            <h3>ä½¿ç”¨pipå®‰è£…</h3>
            <pre><code>pip install pandas</code></pre>
            <h3>ä½¿ç”¨condaå®‰è£…</h3>
            <pre><code>conda install pandas</code></pre>
            <h3>éªŒè¯å®‰è£…</h3>
            <p>åœ¨Pythonäº¤äº’å¼ç¯å¢ƒä¸­è¿è¡Œä»¥ä¸‹ä»£ç éªŒè¯Pandasæ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
            <pre><code>import pandas as pd
print(pd.__version__)</code></pre>
        </section>
        <section class="lesson-content">
            <h2>Pandasæ•°æ®ç»“æ„</h2>
            <p>Pandasæä¾›äº†ä¸¤ç§ä¸»è¦çš„æ•°æ®ç»“æ„ï¼šSerieså’ŒDataFrameã€‚</p>
            <h3>Series</h3>
            <p>Seriesæ˜¯ä¸€ç»´å¸¦æ ‡ç­¾çš„æ•°ç»„ï¼Œå¯ä»¥å­˜å‚¨ä»»ä½•æ•°æ®ç±»å‹ã€‚</p>
            <pre><code>import pandas as pd
# åˆ›å»ºSeries
s = pd.Series([1, 3, 5, np.nan, 6, 8])
print(s)
# åˆ›å»ºå¸¦ç´¢å¼•çš„Series
s = pd.Series([10, 20, 30], index=['a', 'b', 'c'])
print(s)
#<pre><code># ä»å­—å…¸åˆ›å»ºSeries
data = {'AAPL': 150.0, 'MSFT': 250.0, 'GOOG': 1800.0}
stocks = pd.Series(data)
print(stocks)</code></pre>
            
            <div class="interactive-demo">
                <h4>ğŸ¯ äº¤äº’å¼Seriesæ¼”ç¤º</h4>
                <p>ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹ä¸åŒçš„Seriesåˆ›å»ºæ–¹å¼å’Œæ“ä½œæ•ˆæœ</p>
                <div class="demo-controls">
                    <button class="demo-button" onclick="showBasicSeries()">åŸºç¡€Series</button>
                    <button class="demo-button" onclick="showIndexedSeries()">å¸¦ç´¢å¼•Series</button>
                    <button class="demo-button" onclick="showStockSeries()">è‚¡ç¥¨ä»·æ ¼Series</button>
                    <button class="demo-button" onclick="showSeriesOperations()">Seriesè¿ç®—</button>
                </div>
                <div class="chart-container">
                    <div id="seriesChart"></div>
                </div>
                <div class="data-table" id="seriesTable"></div>
            </div>
            <h3>DataFrame</h3>
            <p>DataFrameæ˜¯äºŒç»´çš„ã€å¤§å°å¯å˜çš„ã€å¯ä»¥åŒ…å«å¼‚æ„åˆ—çš„è¡¨æ ¼æ•°æ®ç»“æ„ã€‚</p>
            <pre><code># åˆ›å»ºDataFrame
data = {
    'è‚¡ç¥¨ä»£ç ': ['AAPL', 'MSFT', 'GOOG', 'AMZN'],
    'ä»·æ ¼': [150.0, 250.0, 1800.0, 3200.0],
    'æˆäº¤é‡': [1000000, 800000, 500000, 300000]
}
df = pd.DataFrame(data)
print(df)
# æŒ‡å®šåˆ—é¡ºåº
df = pd.DataFrame(data, columns=['è‚¡ç¥¨ä»£ç ', 'æˆäº¤é‡', 'ä»·æ ¼'])
print(df)
# ä»NumPyæ•°ç»„åˆ›å»ºDataFrame
dates = pd.date_range('20230101', periods=6)
df = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list('ABCD'))
print(df)</code></pre>
            
            <div class="interactive-demo">
                <h4>ğŸ“Š äº¤äº’å¼DataFrameæ¼”ç¤º</h4>
                <p>æ¢ç´¢DataFrameçš„åˆ›å»ºã€æ“ä½œå’Œæ•°æ®åˆ†æåŠŸèƒ½</p>
                <div class="demo-controls">
                    <button class="demo-button" onclick="showBasicDataFrame()">åŸºç¡€DataFrame</button>
                    <button class="demo-button" onclick="showStockDataFrame()">è‚¡ç¥¨æ•°æ®</button>
                    <button class="demo-button" onclick="showDataFrameStats()">ç»Ÿè®¡ä¿¡æ¯</button>
                    <button class="demo-button" onclick="showDataFrameFilter()">æ•°æ®ç­›é€‰</button>
                </div>
                <div class="chart-container">
                    <div id="dataframeChart"></div>
                </div>
                <div class="data-table" id="dataframeTable"></div>
            </div>
        </section>
        
        <section class="lesson-content">
            <h2>æ•°æ®æ“ä½œå¯è§†åŒ–</h2>
            <div class="interactive-demo">
                <h4>ğŸ”„ Pandasæ•°æ®æ“ä½œå®æ—¶æ¼”ç¤º</h4>
                <p>è§‚å¯Ÿä¸åŒPandasæ“ä½œå¯¹æ•°æ®çš„å½±å“</p>
                <div class="demo-controls">
                    <button class="demo-button" onclick="showGroupBy()">åˆ†ç»„èšåˆ</button>
                    <button class="demo-button" onclick="showPivotTable()">é€è§†è¡¨</button>
                    <button class="demo-button" onclick="showMergeJoin()">æ•°æ®åˆå¹¶</button>
                    <button class="demo-button" onclick="showTimeSeriesResample()">æ—¶é—´åºåˆ—é‡é‡‡æ ·</button>
                </div>
                <div class="chart-container">
                    <div id="operationsChart"></div>
                </div>
                <div class="data-table" id="operationsTable"></div>
            </div>
        </section>
        
        <script>
        // åˆ›å»ºtooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip");
        
        // Seriesæ¼”ç¤ºæ•°æ®
        const seriesData = {
            basic: [1, 3, 5, 7, 9],
            indexed: [{index: 'A', value: 10}, {index: 'B', value: 20}, {index: 'C', value: 30}],
            stocks: [{stock: 'AAPL', price: 150}, {stock: 'MSFT', price: 250}, {stock: 'GOOG', price: 1800}, {stock: 'AMZN', price: 3200}],
            operations: [{stock: 'AAPL', original: 150, doubled: 300}, {stock: 'MSFT', original: 250, doubled: 500}]
        };
        
        // DataFrameæ¼”ç¤ºæ•°æ®
        const dataframeData = {
            basic: [
                {è‚¡ç¥¨ä»£ç : 'AAPL', ä»·æ ¼: 150, æˆäº¤é‡: 1000000},
                {è‚¡ç¥¨ä»£ç : 'MSFT', ä»·æ ¼: 250, æˆäº¤é‡: 800000},
                {è‚¡ç¥¨ä»£ç : 'GOOG', ä»·æ ¼: 1800, æˆäº¤é‡: 500000},
                {è‚¡ç¥¨ä»£ç : 'AMZN', ä»·æ ¼: 3200, æˆäº¤é‡: 300000}
            ],
            stats: [
                {æŒ‡æ ‡: 'å¹³å‡ä»·æ ¼', å€¼: 1350},
                {æŒ‡æ ‡: 'æœ€é«˜ä»·æ ¼', å€¼: 3200},
                {æŒ‡æ ‡: 'æœ€ä½ä»·æ ¼', å€¼: 150},
                {æŒ‡æ ‡: 'æ ‡å‡†å·®', å€¼: 1425.2}
            ]
        };
        
        function showBasicSeries() {
            const container = d3.select("#seriesChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(d3.range(seriesData.basic.length))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(seriesData.basic)])
                .range([height, 0]);
            
            g.selectAll(".bar")
                .data(seriesData.basic)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", (d, i) => xScale(i))
                .attr("y", d => yScale(d))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d))
                .attr("fill", "#667eea")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`å€¼: ${d}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            // æ˜¾ç¤ºè¡¨æ ¼
            showSeriesTable(seriesData.basic.map((d, i) => ({ç´¢å¼•: i, å€¼: d})));
        }
        
        function showIndexedSeries() {
            const container = d3.select("#seriesChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 40};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(seriesData.indexed.map(d => d.index))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(seriesData.indexed, d => d.value)])
                .range([height, 0]);
            
            g.selectAll(".bar")
                .data(seriesData.indexed)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xScale(d.index))
                .attr("y", d => yScale(d.value))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.value))
                .attr("fill", "#764ba2")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.index}: ${d.value}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            showSeriesTable(seriesData.indexed.map(d => ({ç´¢å¼•: d.index, å€¼: d.value})));
        }
        
        function showStockSeries() {
            const container = d3.select("#seriesChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 60};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(seriesData.stocks.map(d => d.stock))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(seriesData.stocks, d => d.price)])
                .range([height, 0]);
            
            const colorScale = d3.scaleOrdinal(d3.schemeCategory10);
            
            g.selectAll(".bar")
                .data(seriesData.stocks)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xScale(d.stock))
                .attr("y", d => yScale(d.price))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.price))
                .attr("fill", (d, i) => colorScale(i))
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.stock}: $${d.price}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            showSeriesTable(seriesData.stocks.map(d => ({è‚¡ç¥¨ä»£ç : d.stock, ä»·æ ¼: `$${d.price}`})));
        }
        
        function showSeriesOperations() {
            const container = d3.select("#seriesChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 60};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const stocks = seriesData.operations.map(d => d.stock);
            const x0 = d3.scaleBand().domain(stocks).range([0, width]).padding(0.1);
            const x1 = d3.scaleBand().domain(['original', 'doubled']).range([0, x0.bandwidth()]).padding(0.05);
            const y = d3.scaleLinear().domain([0, 600]).range([height, 0]);
            
            const color = d3.scaleOrdinal().domain(['original', 'doubled']).range(['#667eea', '#764ba2']);
            
            const stockGroups = g.selectAll(".stock")
                .data(seriesData.operations)
                .enter().append("g")
                .attr("class", "stock")
                .attr("transform", d => `translate(${x0(d.stock)},0)`);
            
            stockGroups.selectAll("rect")
                .data(d => [{ key: 'original', value: d.original }, { key: 'doubled', value: d.doubled }])
                .enter().append("rect")
                .attr("x", d => x1(d.key))
                .attr("y", d => y(d.value))
                .attr("width", x1.bandwidth())
                .attr("height", d => height - y(d.value))
                .attr("fill", d => color(d.key))
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.key}: $${d.value}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x0));
            
            g.append("g")
                .call(d3.axisLeft(y));
            
            // æ·»åŠ å›¾ä¾‹
            const legend = g.append("g")
                .attr("transform", `translate(${width - 100}, 20)`);
            
            legend.selectAll(".legend")
                .data(['original', 'doubled'])
                .enter().append("g")
                .attr("class", "legend")
                .attr("transform", (d, i) => `translate(0, ${i * 20})`)
                .each(function(d) {
                    const g = d3.select(this);
                    g.append("rect")
                        .attr("width", 15)
                        .attr("height", 15)
                        .attr("fill", color(d));
                    g.append("text")
                        .attr("x", 20)
                        .attr("y", 12)
                        .text(d === 'original' ? 'åŸå§‹å€¼' : 'ç¿»å€å€¼')
                        .style("font-size", "12px")
                        .style("fill", "#333");
                });
            
            showSeriesTable(seriesData.operations.map(d => ({
                è‚¡ç¥¨ä»£ç : d.stock,
                åŸå§‹ä»·æ ¼: `$${d.original}`,
                ç¿»å€ä»·æ ¼: `$${d.doubled}`
            })));
        }
        
        function showBasicDataFrame() {
            const container = d3.select("#dataframeChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 600)
                .attr("height", 400);
            
            const margin = {top: 20, right: 30, bottom: 60, left: 80};
            const width = 600 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // åˆ›å»ºæ•£ç‚¹å›¾ï¼šä»·æ ¼ vs æˆäº¤é‡
            const xScale = d3.scaleLinear()
                .domain([0, d3.max(dataframeData.basic, d => d.æˆäº¤é‡)])
                .range([0, width]);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(dataframeData.basic, d => d.ä»·æ ¼)])
                .range([height, 0]);
            
            const colorScale = d3.scaleOrdinal(d3.schemeCategory10);
            
            g.selectAll(".dot")
                .data(dataframeData.basic)
                .enter().append("circle")
                .attr("class", "dot")
                .attr("cx", d => xScale(d.æˆäº¤é‡))
                .attr("cy", d => yScale(d.ä»·æ ¼))
                .attr("r", 8)
                .attr("fill", (d, i) => colorScale(i))
                .attr("stroke", "white")
                .attr("stroke-width", 2)
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.è‚¡ç¥¨ä»£ç }<br/>ä»·æ ¼: $${d.ä»·æ ¼}<br/>æˆäº¤é‡: ${d.æˆäº¤é‡.toLocaleString()}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            // æ·»åŠ æ ‡ç­¾
            g.selectAll(".label")
                .data(dataframeData.basic)
                .enter().append("text")
                .attr("class", "label")
                .attr("x", d => xScale(d.æˆäº¤é‡) + 12)
                .attr("y", d => yScale(d.ä»·æ ¼) + 4)
                .text(d => d.è‚¡ç¥¨ä»£ç )
                .style("font-size", "12px")
                .style("fill", "#333");
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale).tickFormat(d => d.toLocaleString()))
                .append("text")
                .attr("x", width / 2)
                .attr("y", 40)
                .style("text-anchor", "middle")
                .style("fill", "#333")
                .text("æˆäº¤é‡");
            
            g.append("g")
                .call(d3.axisLeft(yScale))
                .append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", -60)
                .attr("x", -height / 2)
                .style("text-anchor", "middle")
                .style("fill", "#333")
                .text("ä»·æ ¼ ($)");
            
            showDataFrameTable(dataframeData.basic);
        }
        
        function showStockDataFrame() {
            showBasicDataFrame(); // é‡ç”¨åŸºç¡€DataFrameæ˜¾ç¤º
        }
        
        function showDataFrameStats() {
            const container = d3.select("#dataframeChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 80};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(dataframeData.stats.map(d => d.æŒ‡æ ‡))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(dataframeData.stats, d => d.å€¼)])
                .range([height, 0]);
            
            g.selectAll(".bar")
                .data(dataframeData.stats)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xScale(d.æŒ‡æ ‡))
                .attr("y", d => yScale(d.å€¼))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.å€¼))
                .attr("fill", "#667eea")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.æŒ‡æ ‡}: ${d.å€¼}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            showDataFrameTable(dataframeData.stats);
        }
        
        function showDataFrameFilter() {
            const filteredData = dataframeData.basic.filter(d => d.ä»·æ ¼ > 200);
            
            const container = d3.select("#dataframeChart");
            container.selectAll("*").remove();
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 60};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(filteredData.map(d => d.è‚¡ç¥¨ä»£ç ))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(filteredData, d => d.ä»·æ ¼)])
                .range([height, 0]);
            
            g.selectAll(".bar")
                .data(filteredData)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xScale(d.è‚¡ç¥¨ä»£ç ))
                .attr("y", d => yScale(d.ä»·æ ¼))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.ä»·æ ¼))
                .attr("fill", "#28a745")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.è‚¡ç¥¨ä»£ç }: $${d.ä»·æ ¼}<br/>ç­›é€‰æ¡ä»¶: ä»·æ ¼ > $200`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            // æ·»åŠ ç­›é€‰è¯´æ˜
            g.append("text")
                .attr("x", width / 2)
                .attr("y", -5)
                .style("text-anchor", "middle")
                .style("font-size", "14px")
                .style("fill", "#333")
                .text("ç­›é€‰ç»“æœ: ä»·æ ¼ > $200");
            
            showDataFrameTable(filteredData.map(d => ({
                ...d,
                ç­›é€‰æ¡ä»¶: 'ä»·æ ¼ > $200'
            })));
        }
        
        function showGroupBy() {
            const container = d3.select("#operationsChart");
            container.selectAll("*").remove();
            
            // æ¨¡æ‹Ÿåˆ†ç»„æ•°æ®
            const groupedData = [
                {è¡Œä¸š: 'ç§‘æŠ€', å¹³å‡ä»·æ ¼: 1400, è‚¡ç¥¨æ•°é‡: 3},
                {è¡Œä¸š: 'ç”µå•†', å¹³å‡ä»·æ ¼: 3200, è‚¡ç¥¨æ•°é‡: 1}
            ];
            
            const svg = container.append("svg")
                .attr("width", 500)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 40, left: 80};
            const width = 500 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const xScale = d3.scaleBand()
                .domain(groupedData.map(d => d.è¡Œä¸š))
                .range([0, width])
                .padding(0.1);
            
            const yScale = d3.scaleLinear()
                .domain([0, d3.max(groupedData, d => d.å¹³å‡ä»·æ ¼)])
                .range([height, 0]);
            
            g.selectAll(".bar")
                .data(groupedData)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xScale(d.è¡Œä¸š))
                .attr("y", d => yScale(d.å¹³å‡ä»·æ ¼))
                .attr("width", xScale.bandwidth())
                .attr("height", d => height - yScale(d.å¹³å‡ä»·æ ¼))
                .attr("fill", "#17a2b8")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.è¡Œä¸š}<br/>å¹³å‡ä»·æ ¼: $${d.å¹³å‡ä»·æ ¼}<br/>è‚¡ç¥¨æ•°é‡: ${d.è‚¡ç¥¨æ•°é‡}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            showOperationsTable(groupedData);
        }
        
        function showPivotTable() {
            const container = d3.select("#operationsChart");
            container.selectAll("*").remove();
            
            // æ¨¡æ‹Ÿé€è§†è¡¨æ•°æ®
            const pivotData = [
                {æœˆä»½: '1æœˆ', ç§‘æŠ€è‚¡: 1350, ç”µå•†è‚¡: 3200},
                {æœˆä»½: '2æœˆ', ç§‘æŠ€è‚¡: 1420, ç”µå•†è‚¡: 3150},
                {æœˆä»½: '3æœˆ', ç§‘æŠ€è‚¡: 1380, ç”µå•†è‚¡: 3300}
            ];
            
            const svg = container.append("svg")
                .attr("width", 600)
                .attr("height", 300);
            
            const margin = {top: 20, right: 100, bottom: 40, left: 60};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            const months = pivotData.map(d => d.æœˆä»½);
            const categories = ['ç§‘æŠ€è‚¡', 'ç”µå•†è‚¡'];
            
            const x0 = d3.scaleBand().domain(months).range([0, width]).padding(0.1);
            const x1 = d3.scaleBand().domain(categories).range([0, x0.bandwidth()]).padding(0.05);
            const y = d3.scaleLinear().domain([0, 3500]).range([height, 0]);
            const color = d3.scaleOrdinal().domain(categories).range(['#667eea', '#764ba2']);
            
            const monthGroups = g.selectAll(".month")
                .data(pivotData)
                .enter().append("g")
                .attr("class", "month")
                .attr("transform", d => `translate(${x0(d.æœˆä»½)},0)`);
            
            monthGroups.selectAll("rect")
                .data(d => categories.map(cat => ({ category: cat, value: d[cat] })))
                .enter().append("rect")
                .attr("x", d => x1(d.category))
                .attr("y", d => y(d.value))
                .attr("width", x1.bandwidth())
                .attr("height", d => height - y(d.value))
                .attr("fill", d => color(d.category))
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.category}: $${d.value}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x0));
            
            g.append("g")
                .call(d3.axisLeft(y));
            
            // æ·»åŠ å›¾ä¾‹
            const legend = g.append("g")
                .attr("transform", `translate(${width + 20}, 20)`);
            
            legend.selectAll(".legend")
                .data(categories)
                .enter().append("g")
                .attr("class", "legend")
                .attr("transform", (d, i) => `translate(0, ${i * 20})`)
                .each(function(d) {
                    const g = d3.select(this);
                    g.append("rect")
                        .attr("width", 15)
                        .attr("height", 15)
                        .attr("fill", color(d));
                    g.append("text")
                        .attr("x", 20)
                        .attr("y", 12)
                        .text(d)
                        .style("font-size", "12px")
                        .style("fill", "#333");
                });
            
            showOperationsTable(pivotData);
        }
        
        function showMergeJoin() {
            const container = d3.select("#operationsChart");
            container.selectAll("*").remove();
            
            // æ¨¡æ‹Ÿåˆå¹¶åçš„æ•°æ®
            const mergedData = [
                {è‚¡ç¥¨ä»£ç : 'AAPL', ä»·æ ¼: 150, è¡Œä¸š: 'ç§‘æŠ€', å¸‚å€¼: '2.5T'},
                {è‚¡ç¥¨ä»£ç : 'MSFT', ä»·æ ¼: 250, è¡Œä¸š: 'ç§‘æŠ€', å¸‚å€¼: '2.0T'},
                {è‚¡ç¥¨ä»£ç : 'GOOG', ä»·æ ¼: 1800, è¡Œä¸š: 'ç§‘æŠ€', å¸‚å€¼: '1.5T'}
            ];
            
            const svg = container.append("svg")
                .attr("width", 600)
                .attr("height", 400);
            
            const margin = {top: 20, right: 30, bottom: 60, left: 80};
            const width = 600 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // åˆ›å»ºæ°”æ³¡å›¾
            const xScale = d3.scaleLinear()
                .domain([0, 2000])
                .range([0, width]);
            
            const yScale = d3.scaleLinear()
                .domain([0, 3])
                .range([height, 0]);
            
            const sizeScale = d3.scaleSqrt()
                .domain([1, 3])
                .range([20, 60]);
            
            const colorScale = d3.scaleOrdinal(d3.schemeCategory10);
            
            g.selectAll(".bubble")
                .data(mergedData)
                .enter().append("circle")
                .attr("class", "bubble")
                .attr("cx", d => xScale(d.ä»·æ ¼))
                .attr("cy", d => yScale(parseFloat(d.å¸‚å€¼)))
                .attr("r", (d, i) => sizeScale(i + 1))
                .attr("fill", (d, i) => colorScale(i))
                .attr("opacity", 0.7)
                .attr("stroke", "white")
                .attr("stroke-width", 2)
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.è‚¡ç¥¨ä»£ç }<br/>ä»·æ ¼: $${d.ä»·æ ¼}<br/>è¡Œä¸š: ${d.è¡Œä¸š}<br/>å¸‚å€¼: ${d.å¸‚å€¼}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            // æ·»åŠ æ ‡ç­¾
            g.selectAll(".label")
                .data(mergedData)
                .enter().append("text")
                .attr("class", "label")
                .attr("x", d => xScale(d.ä»·æ ¼))
                .attr("y", d => yScale(parseFloat(d.å¸‚å€¼)) - 5)
                .text(d => d.è‚¡ç¥¨ä»£ç )
                .style("text-anchor", "middle")
                .style("font-size", "12px")
                .style("fill", "#333")
                .style("font-weight", "bold");
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale))
                .append("text")
                .attr("x", width / 2)
                .attr("y", 40)
                .style("text-anchor", "middle")
                .style("fill", "#333")
                .text("è‚¡ç¥¨ä»·æ ¼ ($)");
            
            g.append("g")
                .call(d3.axisLeft(yScale))
                .append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", -60)
                .attr("x", -height / 2)
                .style("text-anchor", "middle")
                .style("fill", "#333")
                .text("å¸‚å€¼ (ä¸‡äº¿)");
            
            showOperationsTable(mergedData);
        }
        
        function showTimeSeriesResample() {
            const container = d3.select("#operationsChart");
            container.selectAll("*").remove();
            
            // æ¨¡æ‹Ÿæ—¶é—´åºåˆ—é‡é‡‡æ ·æ•°æ®
            const originalData = [
                {æ—¥æœŸ: '2023-01-01', ä»·æ ¼: 150},
                {æ—¥æœŸ: '2023-01-02', ä»·æ ¼: 152},
                {æ—¥æœŸ: '2023-01-03', ä»·æ ¼: 148},
                {æ—¥æœŸ: '2023-01-04', ä»·æ ¼: 155},
                {æ—¥æœŸ: '2023-01-05', ä»·æ ¼: 153}
            ];
            
            const resampledData = [
                {å‘¨: 'ç¬¬1å‘¨', å¹³å‡ä»·æ ¼: 151.6, æœ€é«˜ä»·æ ¼: 155, æœ€ä½ä»·æ ¼: 148}
            ];
            
            const svg = container.append("svg")
                .attr("width", 600)
                .attr("height", 300);
            
            const margin = {top: 20, right: 30, bottom: 60, left: 60};
            const width = 600 - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;
            
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // ç»˜åˆ¶åŸå§‹æ•°æ®çº¿å›¾
            const parseDate = d3.timeParse("%Y-%m-%d");
            const formatDate = d3.timeFormat("%m-%d");
            
            const xScale = d3.scaleTime()
                .domain(d3.extent(originalData, d => parseDate(d.æ—¥æœŸ)))
                .range([0, width]);
            
            const yScale = d3.scaleLinear()
                .domain(d3.extent(originalData, d => d.ä»·æ ¼))
                .range([height, 0]);
            
            const line = d3.line()
                .x(d => xScale(parseDate(d.æ—¥æœŸ)))
                .y(d => yScale(d.ä»·æ ¼))
                .curve(d3.curveMonotoneX);
            
            g.append("path")
                .datum(originalData)
                .attr("fill", "none")
                .attr("stroke", "#667eea")
                .attr("stroke-width", 2)
                .attr("d", line);
            
            g.selectAll(".dot")
                .data(originalData)
                .enter().append("circle")
                .attr("class", "dot")
                .attr("cx", d => xScale(parseDate(d.æ—¥æœŸ)))
                .attr("cy", d => yScale(d.ä»·æ ¼))
                .attr("r", 4)
                .attr("fill", "#667eea")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`${d.æ—¥æœŸ}<br/>ä»·æ ¼: $${d.ä»·æ ¼}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            // æ·»åŠ é‡é‡‡æ ·ç»“æœ
            const avgY = yScale(resampledData[0].å¹³å‡ä»·æ ¼);
            g.append("line")
                .attr("x1", 0)
                .attr("x2", width)
                .attr("y1", avgY)
                .attr("y2", avgY)
                .attr("stroke", "#dc3545")
                .attr("stroke-width", 2)
                .attr("stroke-dasharray", "5,5");
            
            g.append("text")
                .attr("x", width - 10)
                .attr("y", avgY - 5)
                .style("text-anchor", "end")
                .style("font-size", "12px")
                .style("fill", "#dc3545")
                .text(`å‘¨å¹³å‡: $${resampledData[0].å¹³å‡ä»·æ ¼}`);
            
            g.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale).tickFormat(formatDate));
            
            g.append("g")
                .call(d3.axisLeft(yScale));
            
            showOperationsTable(resampledData);
        }
        
        function showSeriesTable(data) {
            const table = d3.select("#seriesTable");
            table.selectAll("*").remove();
            
            const tableElement = table.append("table");
            const thead = tableElement.append("thead");
            const tbody = tableElement.append("tbody");
            
            const columns = Object.keys(data[0]);
            
            thead.append("tr")
                .selectAll("th")
                .data(columns)
                .enter()
                .append("th")
                .text(d => d);
            
            const rows = tbody.selectAll("tr")
                .data(data)
                .enter()
                .append("tr");
            
            rows.selectAll("td")
                .data(d => columns.map(col => d[col]))
                .enter()
                .append("td")
                .text(d => d);
        }
        
        function showDataFrameTable(data) {
            const table = d3.select("#dataframeTable");
            table.selectAll("*").remove();
            
            const tableElement = table.append("table");
            const thead = tableElement.append("thead");
            const tbody = tableElement.append("tbody");
            
            const columns = Object.keys(data[0]);
            
            thead.append("tr")
                .selectAll("th")
                .data(columns)
                .enter()
                .append("th")
                .text(d => d);
            
            const rows = tbody.selectAll("tr")
                .data(data)
                .enter()
                .append("tr");
            
            rows.selectAll("td")
                .data(d => columns.map(col => d[col]))
                .enter()
                .append("td")
                .text(d => d);
        }
        
        function showOperationsTable(data) {
            const table = d3.select("#operationsTable");
            table.selectAll("*").remove();
            
            const tableElement = table.append("table");
            const thead = tableElement.append("thead");
            const tbody = tableElement.append("tbody");
            
            const columns = Object.keys(data[0]);
            
            thead.append("tr")
                .selectAll("th")
                .data(columns)
                .enter()
                .append("th")
                .text(d => d);
            
            const rows = tbody.selectAll("tr")
                .data(data)
                .enter()
                .append("tr");
            
            rows.selectAll("td")
                .data(d => columns.map(col => d[col]))
                .enter()
                .append("td")
                .text(d => d);
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºé»˜è®¤å†…å®¹
        document.addEventListener('DOMContentLoaded', function() {
            showBasicSeries();
            showBasicDataFrame();
            showGroupBy();
        });
        </script>
        <section class="lesson-content">
            <h2>æŸ¥çœ‹å’Œæ£€æŸ¥æ•°æ®</h2>
            <p>Pandasæä¾›äº†å¤šç§æ–¹æ³•æ¥æŸ¥çœ‹å’Œæ£€æŸ¥DataFrameä¸­çš„æ•°æ®ã€‚</p>
            <pre><code># æŸ¥çœ‹å‰å‡ è¡Œ
print(df.head())
# æŸ¥çœ‹åå‡ è¡Œ
print(df.tail(3))
# æŸ¥çœ‹ç´¢å¼•
print(df.index)
# æŸ¥çœ‹åˆ—å
print(df.columns)
# æŸ¥çœ‹æ•°æ®æ¦‚è§ˆ
print(df.describe())
# è½¬ç½®æ•°æ®
print(df.T)</code></pre>
        </section>
        <section class="lesson-content">
            <h2>æ•°æ®é€‰æ‹©å’Œæ“ä½œ</h2>
            <p>Pandasæä¾›äº†çµæ´»çš„æ•°æ®é€‰æ‹©æ–¹æ³•ã€‚</p>
            <h3>æŒ‰åˆ—é€‰æ‹©</h3>
            <pre><code># é€‰æ‹©å•åˆ—ï¼ˆè¿”å›Seriesï¼‰
print(df['A'])
# é€‰æ‹©å¤šåˆ—ï¼ˆè¿”å›DataFrameï¼‰
print(df[['A', 'B']])</code></pre>
            <h3>æŒ‰è¡Œé€‰æ‹©</h3>
            <pre><code># é€šè¿‡æ ‡ç­¾é€‰æ‹©è¡Œ
print(df.loc['20230102'])
# é€šè¿‡ä½ç½®é€‰æ‹©è¡Œ
print(df.iloc[3])
# åˆ‡ç‰‡é€‰æ‹©
print(df[0:3])</code></pre>
            <h3>å¸ƒå°”ç´¢å¼•</h3>
            <pre><code># é€‰æ‹©Aåˆ—å¤§äº0çš„è¡Œ
print(df[df['A'] > 0])
# å¤šæ¡ä»¶é€‰æ‹©
print(df[(df['A'] > 0) & (df['B'] < 1)])</code></pre>
        </section>
        <section class="lesson-content">
            <h2>å¤„ç†ç¼ºå¤±æ•°æ®</h2>
            <p>é‡‘èæ•°æ®ä¸­ç»å¸¸å­˜åœ¨ç¼ºå¤±å€¼ï¼ŒPandasæä¾›äº†å¤„ç†ç¼ºå¤±æ•°æ®çš„æ–¹æ³•ã€‚</p>
            <pre><code># åˆ›å»ºåŒ…å«ç¼ºå¤±å€¼çš„DataFrame
df = pd.DataFrame(np.random.randn(5, 3), index=['a', 'c', 'e', 'f', 'h'],
                  columns=['one', 'two', 'three'])
df = df.reindex(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'])
print(df)
# æ£€æŸ¥ç¼ºå¤±å€¼
print(df.isna())
# åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ
print(df.dropna())
# å¡«å……ç¼ºå¤±å€¼
print(df.fillna(0))
# å‰å‘å¡«å……
print(df.fillna(method='ffill'))
# è®¡ç®—æ¯åˆ—çš„å¹³å‡å€¼å¹¶å¡«å……
print(df.fillna(df.mean()))</code></pre>
        </section>
        <section class="lesson-content">
            <h2>é‡‘èåº”ç”¨ç¤ºä¾‹</h2>
            <p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„é‡‘èåº”ç”¨ç¤ºä¾‹ï¼ŒåŠ è½½å’Œåˆ†æè‚¡ç¥¨æ•°æ®ã€‚</p>
            <pre><code>import pandas as pd
import numpy as np
# åˆ›å»ºæ¨¡æ‹Ÿè‚¡ç¥¨æ•°æ®
dates = pd.date_range('2023-01-01', periods=10)
prices = np.array([100, 102, 101, 105, 107, 106, 110, 108, 112, 115])
volumes = np.random.randint(100000, 1000000, size=10)
# åˆ›å»ºDataFrame
df = pd.DataFrame({
    'æ”¶ç›˜ä»·': prices,
    'æˆäº¤é‡': volumes
}, index=dates)
print("åŸå§‹æ•°æ®:")
print(df)
# è®¡ç®—æ—¥æ”¶ç›Šç‡
df['æ”¶ç›Šç‡'] = df['æ”¶ç›˜ä»·'].pct_change()
print("\nåŒ…å«æ”¶ç›Šç‡çš„æ•°æ®:")
print(df)
# è®¡ç®—ç§»åŠ¨å¹³å‡
df['5æ—¥ç§»åŠ¨å¹³å‡'] = df['æ”¶ç›˜ä»·'].rolling(5).mean()
print("\nåŒ…å«ç§»åŠ¨å¹³å‡çš„æ•°æ®:")
print(df)
# è®¡ç®—æ³¢åŠ¨ç‡
df['æ”¶ç›Šç‡æ³¢åŠ¨ç‡'] = df['æ”¶ç›Šç‡'].rolling(5).std() * np.sqrt(252)
print("\nåŒ…å«æ³¢åŠ¨ç‡çš„æ•°æ®:")
print(df)</code></pre>
        </section>
        <section class="lesson-content">
            <h2>å°ç»“</h2>
            <p>åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬ï¼š</p>
            <ul>
                <li>äº†è§£äº†Pandasçš„åŸºæœ¬æ¦‚å¿µå’Œåœ¨é‡‘èä¸­çš„åº”ç”¨</li>
                <li>å­¦ä¹ äº†å¦‚ä½•å®‰è£…Pandas</li>
                <li>æ¢ç´¢äº†Pandasçš„ä¸¤ç§æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šSerieså’ŒDataFrame</li>
                <li>æŒæ¡äº†æŸ¥çœ‹å’Œæ£€æŸ¥æ•°æ®çš„æ–¹æ³•</li>
                <li>å­¦ä¹ äº†æ•°æ®é€‰æ‹©å’Œæ“ä½œçš„åŸºæœ¬æŠ€å·§</li>
                <li>äº†è§£äº†å¦‚ä½•å¤„ç†ç¼ºå¤±æ•°æ®</li>
                <li>åº”ç”¨Pandasè¿›è¡Œäº†ç®€å•çš„è‚¡ç¥¨æ•°æ®åˆ†æ</li>
            </ul>
            <p>è¿™äº›åŸºç¡€çŸ¥è¯†å°†ä¸ºæ‚¨åç»­çš„é‡‘èæ•°æ®åˆ†ææ‰“ä¸‹åšå®åŸºç¡€ã€‚åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ æ•°æ®æ¸…æ´—ä¸è½¬æ¢æŠ€æœ¯ã€‚</p>
            <div class="get-started">
                <h3>å‡†å¤‡å¥½ç»§ç»­å­¦ä¹ äº†å—ï¼Ÿ</h3>
                <p>åœ¨ç»§ç»­ä¸‹ä¸€è¯¾ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»ï¼š</p>
                <ul>
                    <li>æˆåŠŸå®‰è£…äº†Pandas</li>
                    <li>å°è¯•è¿è¡Œäº†æœ¬è¯¾çš„æ‰€æœ‰ç¤ºä¾‹ä»£ç </li>
                    <li>ç†è§£äº†Serieså’ŒDataFrameçš„åŸºæœ¬æ“ä½œ</li>
                </ul>
                <a href="lesson2.html" class="btn btn-large">ç»§ç»­å­¦ä¹ ï¼šæ•°æ®æ¸…æ´—ä¸è½¬æ¢</a>
            </div>
        </section>
        <div class="lesson-navigation">
            <div>
                <a href="../../index.html" class="btn">Â« è¿”å›æ¨¡å—6æ¦‚è§ˆ</a>
            </div>
            <div>
                <a href="lesson2.html" class="btn">ä¸‹ä¸€è¯¾ï¼šæ•°æ®æ¸…æ´—ä¸è½¬æ¢ Â»</a>
            </div>
        </div>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2025 Pythoné‡‘èç¼–ç¨‹è¯¾ç¨‹. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>
</body>
</html>